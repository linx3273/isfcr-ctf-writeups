# 5kr1p7-k1dd13-RS4

**Category**: Cryptography

Help Arrow decipher the message Elliot sent to him\
flag format: isfcr{xxx}

- chall.py
```python
from Crypto.Util.number import (
  getPrime,
  bytes_to_long,
  GCD
)

from sympy import nextprime

def get_good_prime (e, nbits):
  while True:
    p = getPrime(nbits)
    if GCD(p - 1, e) == 1:
      return p

flag = b'isfcr{fake_flag_of_same_length_xxxxxxxxxxxxxxxx}'

assert(len(flag) == 48)

flag1 = bytes_to_long(flag[00:12])
flag2 = bytes_to_long(flag[12:24])
flag3 = bytes_to_long(flag[24:36])
flag4 = bytes_to_long(flag[36:48])

e1 = 65537
nbits1 = 64
p1 = get_good_prime(e1, nbits1)
q1 = get_good_prime(e1, nbits1)
n1 = p1 * q1

e2 = 3
nbits2 = 512
p2 = get_good_prime(e2, nbits2)
q2 = get_good_prime(e2, nbits2)
n2 = p2 * q2

e3 = 0x10001
nbits3 = 512
p3 = get_good_prime(e3, nbits3)
q3 = nextprime(p3)
n3 = 0xa1e86e00a95a9e288edd528f247cff49e835708d88c22bc99b9f6f18635abb4c5cf5d7b433687e18dafac46e5b63ed3bb2b57cb700fd33cbdcfe2b97f97b42b3ec473cb87aeadc1855121a1af3a4eabca2ba31fbf7ad3fdc3830b79f92945dbf3117d114673f5d272cee06121cfdee2e4e3681c3020e4db3813ead46a9230a65

e4 = 0x0285f8d4fe29ce11605edf221868937c1b70ae376e34d67f9bb78c29a2d79ca46a60ea02a70fdb40e805b5d854255968b2b1f043963dcd61714ce4fc5c70ecc4d756ad1685d661db39d15a801d1c382ed97a048f0f85d909c811691d3ffe262eb70ccd1fa7dba1aa79139f21c14b3dfe95340491cff3a5a6ae9604329578db9f5bcc192e16aa62f687a8038e60c01518f8ccaa0befe569dadae8e49310a7a3c3bddcf637fc82e5340bef4105b533b6a531895650b2efa337d94c7a76447767b5129a04bcf3cd95bb60f6bfd1a12658530124ad8c6fd71652b8e0eb482fcc475043b410dfc4fe5fbc6bda08ca61244284a4ab5b311bc669df0c753526a79c1a57
n4 = 0x2aeb637f6152afd4fb3a2dd165aec9d5b45e70d2b82e78a353f7a1751859d196f56cb6d11700195f1069a73d9e5710950b814229ab4c5549383c2c87e0cd97f904748a1302400dc76b42591da17dabaf946aaaf1640f1327af16be45b8830603947a9c3309ca4d6cc9f1a2bcfdacf285fbc2f730e515ae1d93591ccd98f5c4674ec4a5859264700f700a4f4dcf7c3c35bbc579f6ebf80da33c6c11f68655092bbe670d5225b8e571d596fe426db59a6a05aaf77b3917448b2cfbcb3bd647b46772b13133fc68ffabcb3752372b949a3704b8596df4a44f085393ee2bf80f8f393719ed94ab348852f6a5e0c493efa32da5bf601063a033beaf73ba47d8205db

ciphertext1 = pow(flag1, e1, n1)
ciphertext2 = pow(flag2, e2, n2)
ciphertext3 = pow(flag3, e3, n3)
ciphertext4 = pow(flag4, e4, n4)

keys = [
  (n1, e1, ciphertext1),
  (n2, e2, ciphertext2),
  (n3, e3, ciphertext3),
  (n4, e4, ciphertext4),
]

with open('cipher.txt', 'w') as file:
  for index, key in enumerate(keys, start = 1):
    print(f'n{index} =', key[0], file = file)
    print(f'e{index} =', key[1], file = file)
    print(f'c{index} =', key[2], file = file)
    print(file = file)

```

- cipher.txt
```
n1 = 145933748059897832708019630902625713413
e1 = 65537
c1 = 20815876113276619657311562993364235206

n2 = 79947085129566498662963420599903631828586594147070157699879194606163399257647468912907349847287397523461431809515094370690263183496040168367443418206288177245711360769338649362695842226383373391936759651870688507766721363453532451902359013010291121839532960208695350953585750348550889174919781099609984496707
e2 = 3
c2 = 25752514918936635285296087987404233106628442870835028769564878434242476908313650494763

n3 = 113695613888837555189023112264154237220133996822923649393737806323929648088090684225351829943425730233924571317708190054744606421906075372472420115373440728793966647442907101863637418533060598187332117210579532708720029746230145723452869241108694376173570544798707987242808923153085562962232590668047363279461
e3 = 65537
c3 = 15110516830646985493213729395253709174965116203882207409275279024386140300153333116993929355795891402769433644025475549632076040555307767073986229570122946822689315380060414438665645837015595316155374706915873400617737812178169948193127601890936790115887803610639316185616536339234846602476517268954159940092

n4 = 338630205260455689413627911306068443537112802550361922213620660503310212139001530156458392949653034244789612680980241965923780722889133495349537107789761426092510299239678696031652780059016898519278860185536978111680123402473365833456785718098200501968322228116681190425490850863660038143310790555506293106653050174262471649179173093656763946257235681980586392230447218179278964626176124426615857733950102117938674282636936094069075258237416065546593509302494726576026227551920883962084579635168761189995794814926094510046419165007371450799003658587100556051088147493947712592469412133312536422828670173807709914587
e4 = 318540665379393469901456665807211509077755719995811520039095212139429238053864597311950397094944291616119321660193803737677538864969915331331528398734504661147661499115125056479426948683504604460936703005724827506058051215012025774714463561829608252938657297504427643593752676857551877096958959488289759878259498255905255543409142370769036479607835226542428818361327569095305960454592450213005148130508649794732855515489990191085723757628463901282599712670814223322126866814011761400443596552984309315434653984387419451894484613987942298157348306834118923950284809853541881602043240244910348705406353947587203832407
c4 = 23118977034075324457671206266295223969166863296858778892756522910658629912491685271900208910834878850414818567445490694317036392338521999862490113469259970245801707968528282768963029115102336290029803859804153586094807210840230218907517472472327772448857563973158334207823939095208706464543488296575757186859084531717975302587407937228750314797969022571952762896856001587929123705962440033883511960770678996174203111513661729398556141756579002642379120690056619585008247544590942977866122385729130614831730883419667309167729969405731704436155641366873219985531783025363579422300336035357141643609173402740169428727
```

- **Additional hint**: Also, someone said this could be helpful but I really don't understand how. It's all gibberish. Maybe you can try figuring it out?
```
Vm0wd2QyUXlWa2hWV0doVVYwZG9jRlZ0TVZOWFZsbDNXa1JTVjFac2JETlhhMk0xVjBaS2MySkVUbGhoTVhCUVZteFZlRll5VGtsalJtaG9UV3N3ZUZadGNFdFRNVTVJVm10a1dHSkdjRTlaYlhSTFZsWmFkR05GZEZSTlZXdzFWa2QwYzJGV1NuUlZhemxhVmpOb2FGcFdXbUZrUjFaSVpFWlNUbFpVVmxsV1Z6QXhWREpHUjFOdVVsWmlSMmhvVm1wT2IyRkdXbGRYYlhSWFRWWmFlVmRyV25kV01ERldZMFZ3VjJKVVJYZFpWRXBIVWpGT2RWWnNTbWxTTW1oWlYxZDRVMVl4U2tkWGJHUllZbGhTV0ZSV1pGTmxiRmw1VFZSU1ZrMUVSa1pWYkZKRFZqSkZlVlJZYUZkU1JYQklWbXBHVDJSV1VuUmpSazVYVWpOb1dsWXhXbXROUjFGNVZXNU9XRmRIYUZsWmJGWmhZMVphZEdONlJrNVdiWFF6VjJ0U1UxWnJNVVZTYTFwWFlsaG9NMVpxUm1GU2JVbDZXa1prYUdFeGNGbFhhMVpoVkRKT2MyTkZaR2hTTW5oVVdWUk9RMWRXV1hoYVJFSmFWbTE0VjFSVmFHOWhiRXAwVld4c1dtSkhhRlJXTUZwVFZqRmtkVnBGTlZOaWEwcElWbXBLTkZReFdsaFRiRnBxVWxkU1lWUlZXbUZsYkZweFVtMUdVMkpWVmpaWlZWcHJZVWRGZUdORVdsZGlXRUpJVmtSS1UxWXhaSFZVYkZKcFZqTm9WVlpHVWt0aU1XUlhWMWhvWVZKR1NuQlVWbHBYVFRGU1ZtRkhPVmRpVlhCSVZqSjRVMWR0U2tkWGJXaFhZVEZ3ZWxreWVHdGtSa3AwWlVaa2FWWnJiekZXYlhCTFRrWlJlRmRzYUZSaVJuQnhWV3hrYjFsV1VsWlhhM1JvVW14c00xWXllSGRpUjBwSFYycENXbFpXY0haV2FrcExVMVpHZEU5V1pHaGhNSEJ2Vmxod1MxVXhXWGhWYmxaVllrWndjRlpxVG05WFZscEhXVE5vYVUxcmJEUldNV2h2VjBkS1JrNVdVbFZXTTJoSVZHdGFZVmRIVWtoa1JtUnBWbGhDU2xkV1ZtOVVNVnB5VFZWa1YxZEhhR0ZVVmxwM1lVWndSbHBGT1U5aVJYQXdXbFZhVDJGV1RrWlRhM1JYVFc1b1dGWnFTa1psUm1SWllrWlNhRTFzU25oV1YzaGhaREZaZUZkdVVteFNXRkpZVkZaYVlWTkdWbk5WYms1V1ZteGFWbFJWVW5KUVVUMDk=
```


# Solution
The title of this challenge is read as Script Kiddie which basically is an unskilled person who uses scripts, programs for attacks etc.

The additional hint (let's call it gibberish.txt) is encoded in base64 format. Decoding the base64 gives another base64 text. Repeatedly decoding it (for about 10-12 times) in a [base64 decoder](https://www.base64decoder.io/) we obtain this link - `https://github.com/Ganapati/RsaCtfTool`. This tool can be used to decode all four parts of the encrypted message provided in `cipher.txt`

# Flag
`isfcr{5kr1p7_k1dd13s_u53_RsaCtfTool_f0r_th3_w1n}`
# Tools/References
[RSACtfTool](https://github.com/Ganapati/RsaCtfTool)\
[Youtube](https://www.youtube.com/watch?v=vf1z7GlG6Qo)\
[cryptobook.nakov.com](https://cryptobook.nakov.com/asymmetric-key-ciphers/the-rsa-cryptosystem-concepts)\
[Wikipedia](https://en.wikipedia.org/wiki/RSA_(cryptosystem))

# Note
- `decoder_auth.py` is the solution provided by the Author of the question and does not use RSAToolCtf