# shared modulus
p = 0xc4f8862619343f912fecded3b8d26a4d2eaded138a1510a20fda7fce9b3512bcd4a1117a7f91ed4fbf805ecd0e93bd851d7fc59581408a1d0551ec708112d26c25cbb1f9c8a249e96cb6898365c01ee14d3c4e231e98d733ac256cbf0343c76d03b5a5bdc97244c3b0bc2158a9bfc6c52f1ce128a60ad79c36d9285ffb75c7d1
# base
g = 0x65

# alice private key
a = 0x39001f56b8e1df7b39bd4b916bf950f67998ab024b6a52778f923e36c613c09e74b9ae73d02302cfcdcd90abda115edf44aa46cce16a2ecc3946fc175152fe71246a9ad1a4ef7687b76b398ea56fe5c3fbe7b2d21e4ed11927a919edf882ccffb05f14693f291ad6267b36364f291533fae9707e41f662545171e40c6140354d
# alice public key
A= 0x35d86208b331e8175dacd8307eda2392559a41cacf28e936229754ff9fe554f17dc252866495bc6ff073e8b1033c7171bc64927cf8eb05e3ba1854c1a502e234945d14ab708a97b4453668b54c08fda06e3434dec3a4a7950cb4c5497761bada005c058a49e2c21002ab8be774e5435e40f1fcf050a4ac62d00b7efc3fd09c23

# bob private key
b = 0x728d73797f204cb83c0d502522e97a66d5d90df0ae944e133f46bbdec9e9a351a965bc66ba1a50d3d7e8ac59eb42c8e50c3868098ebebd8f723d000f518e9c4ff8fb3ecce27d79cb5f2a1cb38f67d387a7385845c96ec920e80854d54d1b6657e97dbd8d5b3b9d8df4fca4f8a08eedf88ccf84403648a5bdb84fd1b43a821e69\
# bob public key
B = 0x49968ee397d6448d1a85a1234086f963a57d4cf4980f78c394e0a0f372ea6921dcd5516d7f58a21c4ee6559bba94c6d69e3ffbc1939b2c6f8ae79c2ededf38648f9d34ad49e084d44fcc0ab9dc873fa7a433d0c1ebfc048bd28273f2f88ca3fff179bff9d8a9955612699b11453ae89b1bf5fdc5d60e2db790d2c9787ff319e6

# base + pvt key = public key
# public key is shared to the other,
# pvt key added to the public key giving common key

# shared key (the shared secret) = A^b mod p = B^a mod p
secret1 = hex(pow(int(A),int(b),int(p)))
secret2 = hex(pow(int(B),int(a),int(p)))
if secret1==secret2:
    print(secret1)